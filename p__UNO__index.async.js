"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[198],{44475:function(Nn,I,o){o.r(I),o.d(I,{default:function(){return ln}});var z=o(25359),N=o.n(z),W=o(49811),H=o.n(W),K=o(93525),V=o.n(K),J=o(54306),g=o.n(J),f=o(93236),R={"flex-between":"flex-between___bfW2N",box:"box___x16Kb",inner:"inner___uwIyM"},$=o(50239),F=o(6842),j=o(8637),m=o(60614),B=o(70292),Q=o(62636),X=o(10043),T=o(19043),L=o(89803),k=o(34667),b=o(27759),q=o(15305),_=o(11436),nn=o(69497),d=o(32699),en=o(67806),tn=o(11333),rn=o.n(tn),on=o(95170),y=o.n(on),n=o(62086),an=function(C){var D=(0,f.useMemo)(function(){var c=[];for(var u in C.result)u!=="date"&&c.push({point:C.result[u],name:u});return c},[C.result]);return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)($.Z,{header:!1,footer:!1,bordered:!0,dataSource:D,renderItem:function(u){return(0,n.jsxs)($.Z.Item,{children:[(0,n.jsx)(F.Z.Text,{children:u==null?void 0:u.name}),u.point>0&&(0,n.jsx)(F.Z.Text,{style:{color:"red"},children:u==null?void 0:u.point}),u.point==0&&(0,n.jsx)(F.Z.Text,{children:u==null?void 0:u.point}),u.point<0&&(0,n.jsx)(F.Z.Text,{style:{color:"green"},children:u==null?void 0:u.point})]})}})})},O=!0,un=function(){var C=f.useState([]),D=g()(C,2),c=D[0],u=D[1],cn=f.useState(0),A=g()(cn,2),$n=A[0],Ln=A[1],dn=j.Z.useForm(),vn=g()(dn,1),Z=vn[0],fn=f.useState([]),G=g()(fn,2),p=G[0],E=G[1],hn=f.useState(!1),M=g()(hn,2),mn=M[0],U=M[1],pn=f.useState(!1),w=g()(pn,2),xn=w[0],Y=w[1];(0,f.useEffect)(function(){O&&(y().getItem("players").then(function(t){u(t||[])}),y().getItem("logs").then(function(t){E(t||[])}),O=!1)},[]);var gn=function(e){var r=0;return p.forEach(function(a){r+=a[e]||0}),Number(r||0)},yn=(0,f.useMemo)(function(){var t=(0,d.cloneDeep)(p),e={date:"\u603B\u8BA1"};return c.forEach(function(r){e[r.name]=gn(r.name)}),t.push(e),t},[p,c]),Cn=(0,f.useMemo)(function(){var t=c.map(function(e){return{title:e.name,dataIndex:e.name,key:e.name,render:function(a){return(0,n.jsxs)(n.Fragment,{children:[Number(a)>0&&(0,n.jsx)("span",{style:{color:"red"},children:"+".concat(a)}),!Number(a)&&"".concat(0),Number(a)<0&&(0,n.jsx)("span",{style:{color:"green"},children:"".concat(a)})]})}}});return[{title:"\u65E5\u671F",dataIndex:"date",key:"date",width:180}].concat(V()(t),[{title:"\u64CD\u4F5C",width:80,fixed:"right",render:function(r,a,i){return(0,n.jsx)(n.Fragment,{children:i!==p.length&&(0,n.jsx)(m.ZP,{danger:!0,onClick:function(){return jn(a,i)},type:"link",children:"\u5220\u9664"})})}}])},[c]),Fn=function(){y().setItem("players",[]),y().setItem("logs",[])},jn=function(e,r){var a=(0,d.cloneDeep)(p[r]);B.Z.confirm({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F",okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){var l=(0,d.cloneDeep)(p);l.splice(r,1),E(l)}})},Dn=function(){var t=H()(N()().mark(function e(){var r,a;return N()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,Z.validateFields();case 3:r=Z.getFieldsValue(),a=(0,d.cloneDeep)(c),a.push({name:r.name,description:"",avatar:"",point:0,type:"normal"}),u(a),Z.resetFields(),Q.ZP.success((0,n.jsx)(n.Fragment,{children:"\u70ED\u70C8\u6B22\u8FCE\u3010".concat(r.name,"\u3011\u540C\u5FD7\u52A0\u5165\u6E38\u620F\uFF0C\u795D\u60A8\u798F\u5982\u4E1C\u6D77\uFF0C\u5BFF\u6BD4\u5357\u5C71~")})),l.next=13;break;case 11:l.prev=11,l.t0=l.catch(0);case 13:case"end":return l.stop()}},e,null,[[0,11]])}));return function(){return t.apply(this,arguments)}}(),Zn=function(e){var r=(0,d.cloneDeep)(c[e]);B.Z.confirm({title:"\u8B66\u544A",content:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u3010".concat(r.name,"\u3011\u5417\uFF1F"),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88",onOk:function(){var i=(0,d.cloneDeep)(c);i.splice(e,1),u(i)}})},Pn=function(e,r){if(r!==null){var a=(0,d.cloneDeep)(c);a[e].point=r,u(a)}},Rn=function(){var e=(0,d.cloneDeep)(c);e=e.map(function(r,a){return{name:r.name,description:r.description,avatar:r.avatar,point:0,type:"normal"}}),console.log(e),u(e),Y(!1)},Bn=function(e){var r={};return r.date=rn()().format("YYYY-MM-DD h:mm:ss"),e.forEach(function(a,i){r[a.name]=a.lastPoint}),r},Tn=function(){var e,r=(0,d.cloneDeep)(c);r.sort(function(v,P){return v.point-P.point});var a=0,i=(e=(0,d.cloneDeep)(r[1]))===null||e===void 0?void 0:e.point,l=0;r.map(function(v,P){(v==null?void 0:v.point)<=i?(v.type="winner",l++):v.type="loser"}),u(r);var S=En(r,l),s=S.result,x=(0,d.cloneDeep)(p),h=Bn(s);x.push(h),E(x),y().setItem("players",r),y().setItem("logs",x),Y(!0),B.Z.info({width:"80%",icon:!1,title:(0,n.jsx)(n.Fragment,{children:"\u{1F3C6}\u{1F3C6}\u{1F3C6}\u7ED3\u7B97\u9875\u9762\u{1F3C6}\u{1F3C6}\u{1F3C6}"}),content:(0,n.jsx)(an,{result:h}),okText:"\u786E\u5B9A",cancelText:"\u53D6\u6D88"})},En=function(e,r){var a=e.filter(function(s){return s.type==="winner"}),i=0;e==null||e.forEach(function(s,x){s.type==="loser"&&(i+=s.point)});var l=i/r,S=e.map(function(s,x){var h=l;return s.type==="winner"?x===0?a==null||a.forEach(function(v,P){if(P!==0){var In=Math.min(v==null?void 0:v.point,l);h=h+In}}):h=l-(s==null?void 0:s.point)<0?0:l-(s==null?void 0:s.point):h=-(s==null?void 0:s.point),{rank:x+1,name:s==null?void 0:s.name,lastPoint:h}});return{result:S,plan:[]}},Sn=function(e){return e==="winner"?"red":e==="loser"?"green":"blue"};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(en._z,{title:"UNO\u8BA1\u5206\u5668",className:R.box,style:{minHeight:"100vh"},children:(0,n.jsxs)("div",{className:R.inner,children:[(0,n.jsxs)(j.Z,{form:Z,layout:"inline",children:[(0,n.jsx)(j.Z.Item,{rules:[{required:!0,message:"\u4F60\u5F97\u8D77\u4E2A\u540D\u554A"}],label:"Player Name",name:"name",children:(0,n.jsx)(X.Z,{maxLength:8})}),(0,n.jsx)(j.Z.Item,{children:(0,n.jsxs)(T.Z,{children:[(0,n.jsx)(m.ZP,{onClick:Dn,children:"\u521B\u5EFA\u73A9\u5BB6"}),(0,n.jsx)(m.ZP,{onClick:Fn,children:"\u91CD\u5F00\u623F\u95F4"})]})})]}),(0,n.jsx)(L.Z,{}),(0,n.jsx)(T.Z,{direction:"vertical",size:"middle",style:{width:"100%"},children:c.map(function(t,e){return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(k.Z.Ribbon,{text:(0,n.jsxs)(n.Fragment,{children:[(t==null?void 0:t.type)==="winner"&&"Winner \u{1F911}",(t==null?void 0:t.type)==="loser"&&"Loser \u{1F62D}",(t==null?void 0:t.type)==="normal"&&"Ready \u{1F60E}"]}),color:Sn(t==null?void 0:t.type),children:(0,n.jsx)(b.Z,{title:t.name,size:"small",children:(0,n.jsxs)("div",{className:R["flex-between"],children:[(0,n.jsx)(q.Z,{addonBefore:"-",width:50,min:0,value:t.point,onChange:function(a){return Pn(e,a)}}),(0,n.jsx)(m.ZP,{danger:!0,type:"link",onClick:function(){return Zn(e)},children:"\u8E22\u4E86"})]})})},e)})})}),(0,n.jsx)(L.Z,{}),(0,n.jsxs)(T.Z,{children:[(0,n.jsx)(m.ZP,{color:"success",disabled:xn,type:"primary",onClick:Tn,children:"\u7ED3\u7B97\u672C\u5C40"}),(0,n.jsx)(m.ZP,{color:"success",type:"primary",onClick:function(){U(!0)},children:"\u8BB0\u5206\u677F"}),(0,n.jsx)(m.ZP,{color:"success",type:"primary",onClick:function(){Rn()},children:"\u65B0\u5F00\u4E00\u5C40"})]})]})}),(0,n.jsx)(_.Z,{title:"\u8BB0\u5206\u677F",width:1200,open:mn,onClose:function(){U(!1)},children:(0,n.jsx)(nn.Z,{dataSource:yn,columns:Cn,pagination:!1})})]})},ln=un}}]);
